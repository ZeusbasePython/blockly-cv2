<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Generating Python cv2 code</title>
  <script src="js/blockly_compressed.js"></script>
  <script src="js/blocks_compressed.js"></script>
  <script src="js/python_compressed.js"></script>
  <!--script src="js/v24.js"></script-->
  <script src="js/v30.js"></script>
  <script src="js/en.js"></script>
  <script src="js/gen/python.js"></script>
  <script src="js/gen/blocks.js"></script>
  <script>

Blockly.Blocks['convertTo'] = {
  init: function() {
    this.setColour(45);
    this.appendValueInput("input")
        .setCheck("image")
        .appendField("convertTo")
    this.appendDummyInput()
        .appendField(new Blockly.FieldDropdown([
          ["float","np.float32"],
          ["uchar","np.uint8"],
          ["int", "np.int32"],]), "flag")
    this.setOutput(true, "image")
    this.setInputsInline(true)
    this.setTooltip('')
  }
};
Blockly.Python['convertTo'] = function(block) {
  var input = Blockly.Python.valueToCode(block, 'input', Blockly.Python.ORDER_ATOMIC);
  var flag = block.getFieldValue('flag');
  var code = "np.asarray(" + input + ", dtype="+flag+")";
  return [code, Blockly.Python.ORDER_NONE];
};

Blockly.Blocks['roi'] = {
  init: function() {
    this.setColour(45);
    this.appendValueInput("input")
        .setCheck("image");
    this.appendDummyInput()
        .appendField("roi")
        .appendField("y")
        .appendField(new Blockly.FieldTextInput(""), "y0")
        .appendField(":")
        .appendField(new Blockly.FieldTextInput(""), "y1")
        .appendField("x")
        .appendField(new Blockly.FieldTextInput(""), "x0")
        .appendField(":")
        .appendField(new Blockly.FieldTextInput(""), "x1");
    this.setInputsInline(true);
    this.setOutput(true);
    this.setTooltip('');
  }
};
Blockly.Python['roi'] = function(block) {
  var input = Blockly.Python.valueToCode(block, 'input', Blockly.Python.ORDER_ATOMIC);
  var y0 = block.getFieldValue('y0');
  var y1 = block.getFieldValue('y1');
  var x0 = block.getFieldValue('x0');
  var x1 = block.getFieldValue('x1');
  var code = input + "[" + y0 + ":" + y1 + "," + x0 + ":" + x1 + "]";
  return [code, Blockly.Python.ORDER_NONE];
};

Blockly.Blocks['indexed'] = {
  init: function() {
    this.setColour(45);
    this.appendDummyInput()
        .appendField("indexed")
    this.appendValueInput("input")
        .setCheck("image");
    this.appendValueInput("index")
        .appendField("index");
    this.setInputsInline(true);
    this.setOutput(true);
    this.setTooltip('');
  }
};
Blockly.Python['indexed'] = function(block) {
  var index = Blockly.Python.valueToCode(block, 'index', Blockly.Python.ORDER_ATOMIC);
  var input = Blockly.Python.valueToCode(block, 'input', Blockly.Python.ORDER_ATOMIC);
  var code = input + "[" + index + "]";
  return [code, Blockly.Python.ORDER_NONE];
};
Blockly.Blocks['lists_append'] = {
  init: function() {
    this.setColour(45);
    this.appendDummyInput()
        .appendField("append")
    this.appendValueInput("list")
    this.appendValueInput("item")
        .appendField("item")
    this.setInputsInline(true);
    this.setTooltip('append items to a list');
    this.setPreviousStatement(true);
    this.setNextStatement(true);
  }
};
Blockly.Python['lists_append'] = function(block) {
  var list = Blockly.Python.valueToCode(block, 'list', Blockly.Python.ORDER_ATOMIC);
  var item = Blockly.Python.valueToCode(block, 'item', Blockly.Python.ORDER_ATOMIC);
  var code = list + ".append(" + item + ")\n";
  return code;
};

Blockly.Blocks['imgsize'] = {
  init: function() {
    this.setColour(45);
    this.appendDummyInput()
        .appendField("imgsize")
    this.appendValueInput("image")
    this.setInputsInline(true);
    this.setOutput(true);
    this.setTooltip('');
  }
};
Blockly.Python['imgsize'] = function(block) {
  var image = Blockly.Python.valueToCode(block, 'image', Blockly.Python.ORDER_ATOMIC);
  var code = "np.shape(" + image + ")[:-1]";
  return [code, Blockly.Python.ORDER_NONE];
};

Blockly.Blocks['imread'] = {
  init: function() {
    this.setColour(45);
    this.appendDummyInput()
        .appendField("imread")
        .appendField(new Blockly.FieldCheckbox("FALSE"), "grey")
        .appendField(new Blockly.FieldTextInput("media/lena.jpg"), "filename")
    this.setOutput(true, "image");
    this.setTooltip('');
  }
};
Blockly.Python['imread'] = function(block) {
  var filename = block.getFieldValue('filename');
  var grey = block.getFieldValue('grey') == 'TRUE';
  var flag = grey ? 0 : 1;
  var code = "cv2.imread('" + filename + "'," + flag + ")";
  return [code, Blockly.Python.ORDER_NONE];
};

Blockly.Blocks['imshow'] = {
  init: function() {
    this.setColour(45);
    this.appendDummyInput()
        .appendField("imshow")
        .appendField(new Blockly.FieldVariable('mywin'), 'windowname')
        //.appendField(new Blockly.FieldTextInput("mywin"), "windowname");
    this.appendValueInput("image")
        .setCheck("image");
    this.setPreviousStatement(true);
    this.setNextStatement(true);
    this.setTooltip('');
  }
};
Blockly.Python['imshow'] = function(block) {
  var image = Blockly.Python.valueToCode(block, 'image', Blockly.Python.ORDER_ATOMIC);
  var windowname = block.getFieldValue('windowname');
  var code = "cv2.imshow('" + windowname + "',"+ image +")\r\n";
  return code;
};

Blockly.Blocks['waitkey'] = {
  init: function() {
    this.setColour(45);
    this.setInputsInline(true);
    this.appendDummyInput()
        .appendField("waitKey");
    this.appendDummyInput()
        .appendField("millis")
        .appendField(new Blockly.FieldTextInput("0"), "millis");
    this.appendDummyInput()
        .appendField("key")
        .appendField(new Blockly.FieldTextInput("27"), "key");
    this.appendStatementInput("statement");
    this.setPreviousStatement(true);
    this.setNextStatement(true);
    this.setTooltip('');
  }
};
Blockly.Python['waitkey'] = function(block) {
  var m = block.getFieldValue('millis');
  var k = block.getFieldValue('key');
  var s = Blockly.Python.statementToCode(block, 'statement') || '  pass\n';
  var code = "if cv2.waitKey("+m+")&0xff == "+k+":\n"+s;
  //return [code, Blockly.Python.ORDER_NONE];
  return code;
};

Blockly.Blocks['onmouse'] = {
  init: function() {
    this.setColour(45);
    this.setInputsInline(true);
    this.appendDummyInput()
        .appendField("onmouse")
        .appendField(new Blockly.FieldVariable('mywin'), 'windowname')
        .appendField(new Blockly.FieldVariable('button'), 'button')
        .appendField(new Blockly.FieldVariable('x'), 'x')
        .appendField(new Blockly.FieldVariable('y'), 'y')
        .appendField(new Blockly.FieldVariable('state'), 'state');
    this.appendStatementInput("statement");
    this.setPreviousStatement(true);
    this.setNextStatement(true);
    this.setTooltip('');
  },
  getVars: function() {
    return [
      this.getFieldValue('windowname'),
      this.getFieldValue('button'),
      this.getFieldValue('x'),
      this.getFieldValue('y'),
      this.getFieldValue('state')];
  },
  renameVar: function(oldName, newName) {
    if (Blockly.Names.equals(oldName, this.getFieldValue('windowname'))) { this.setFieldValue(newName, 'windowname'); }
    if (Blockly.Names.equals(oldName, this.getFieldValue('button'))) { this.setFieldValue(newName, 'button'); }
    if (Blockly.Names.equals(oldName, this.getFieldValue('x'))) { this.setFieldValue(newName, 'x'); }
    if (Blockly.Names.equals(oldName, this.getFieldValue('y'))) { this.setFieldValue(newName, 'y'); }
    if (Blockly.Names.equals(oldName, this.getFieldValue('state'))) { this.setFieldValue(newName, 'state'); }
  },
};
Blockly.Python['onmouse'] = function(block) {
  var w = block.getFieldValue('windowname');
  var k = block.getFieldValue('key');
  var s = Blockly.Python.statementToCode(block, 'statement') || '  pass\n';
  var code = "def onmouse(button, x, y, state, param):\n" +s + "\n" + "cv2.setMouseCallback('"+w+"', onmouse)\n";
  return code;
};

Blockly.Blocks['cascade'] = {
  init: function() {
    this.setColour(290);
    this.appendDummyInput()
        .appendField("create")
        .appendField(new Blockly.FieldVariable('cascade'), 'cascade')
        .appendField(new Blockly.FieldTextInput("opencv/data/haarcascades/haarcascade_frontalface_alt2.xml"), "xmlfile");
    this.setPreviousStatement(true);
    this.setNextStatement(true);
    this.setTooltip('');
  },
  getVars: function() {
    return [this.getFieldValue('cascade')];
  },
  renameVar: function(oldName, newName) {
    if (Blockly.Names.equals(oldName, this.getFieldValue('cascade'))) {
      this.setFieldValue(newName, 'cascade');
    }
  },
};
Blockly.Python['cascade'] = function(block) {
  var text_input = block.getFieldValue('xmlfile');
  var cascade = block.getFieldValue('cascade');
  var code = cascade + " = cv2.CascadeClassifier('"+text_input+"')\n" +
             "if "+cascade+".empty(): raise Exception(\"your cascade is empty. are you sure, the path is correct ?\")\n"
  return code;
};

Blockly.Blocks['findobjects'] = {
  init: function() {
    this.setColour(290);
    this.appendDummyInput()
        .appendField("detect")
        .appendField(new Blockly.FieldVariable('cascade'), 'cascade');
    this.appendValueInput("image")
        .setCheck("image");
    this.setOutput(true);
    this.setTooltip('find objects in an image and return a list of rects.\nto draw them, you will need the tl and br items');
  },
  getVars: function() {
    return [this.getFieldValue('cascade')];
  },
  renameVar: function(oldName, newName) {
    if (Blockly.Names.equals(oldName, this.getFieldValue('cascade'))) {
      this.setFieldValue(newName, 'cascade');
    }
  },
};
Blockly.Python['findobjects'] = function(block) {
  var image = Blockly.Python.valueToCode(block, 'image', Blockly.Python.ORDER_ATOMIC);
  var cascade = block.getFieldValue('cascade');
  var code = "cascade.detectMultiScale("+image+")"
  return [code, Blockly.Python.ORDER_NONE];
};

/*
Blockly.Blocks['people'] = {
  init: function() {
    this.setColour(260);
    this.appendDummyInput()
        .appendField("create")
        .appendField(new Blockly.FieldVariable('people'), 'people');
    this.setTooltip('create an peopledetector object');
    this.setPreviousStatement(true);
    this.setNextStatement(true);
  },
  getVars: function() {
    return [this.getFieldValue('people')];
  },
  renameVar: function(oldName, newName) {
    if (Blockly.Names.equals(oldName, this.getFieldValue('people'))) {
      this.setFieldValue(newName, 'people');
    }
  },
};
Blockly.Python['people'] = function(block) {
  var people = block.getFieldValue('people');
  var code = people + " = cv2.HOGDescriptor()\n" +
             people + ".setSVMDetector( cv2.HOGDescriptor_getDefaultPeopleDetector() )\n"
  return code;
};

Blockly.Blocks['peopledetect'] = {
  init: function() {
    this.setColour(260);
    this.appendDummyInput()
        .appendField("detect");
    this.appendValueInput("image")
        .setCheck("image")
        .appendField(new Blockly.FieldVariable('people'), 'people');
    this.setOutput(true);
    this.setTooltip('find people in an image, return a list of bounding boxes');
  },
  getVars: function() {
    return [this.getFieldValue('people')];
  },
  renameVar: function(oldName, newName) {
    if (Blockly.Names.equals(oldName, this.getFieldValue('people'))) {
      this.setFieldValue(newName, 'people');
    }
  },
};
Blockly.Python['peopledetect'] = function(block) {
  var image = Blockly.Python.valueToCode(block, 'image', Blockly.Python.ORDER_ATOMIC);
  var people = block.getFieldValue('people');
  var code = people + ".detect("+image+")[0]"
  return [code, Blockly.Python.ORDER_NONE];
};
*/


Blockly.Blocks['videocapture'] = {
  init: function() {
    this.setColour(135);
    this.appendDummyInput()
        .appendField("VideoCapture")
        .appendField(new Blockly.FieldTextInput("0"), "input")
        .appendField(new Blockly.FieldVariable('img'), 'img');
    this.appendStatementInput("statements")
        .setCheck("image");
    this.setPreviousStatement(true);
    this.setNextStatement(true);
    this.setTooltip('');
  },
  getVars: function() {
    return [this.getFieldValue('img')];
  },
  renameVar: function(oldName, newName) {
    if (Blockly.Names.equals(oldName, this.getFieldValue('img'))) {
      this.setFieldValue(newName, 'img');
    }
  },
};
Blockly.Python['videocapture'] = function(block) {
  var text_input = block.getFieldValue('input');
  var statements_name = Blockly.Python.statementToCode(block, 'statements');
  var img_name = block.getFieldValue('img');
  var code = "cap=cv2.VideoCapture("+text_input+")\n" +
             "if not cap.isOpened(): raise Exception(\"your input:"+text_input+" could not be opened !\")\n" +
             "while cap.isOpened():\n  _,"+img_name+"=cap.read()\n"+statements_name;
  return code;
};




Blockly.Blocks['VideoWriter_VideoWriter'] = {
  init: function() {
    this.setColour(22);
    this.appendDummyInput()
        .appendField('VideoWriter_VideoWriter')
        .appendField(new Blockly.FieldVariable('writer'), 'writer');
    this.appendDummyInput()
        .appendField('filename')
        .appendField(new Blockly.FieldTextInput('my.asf'), 'filename')
    this.appendDummyInput()
        .appendField('fourcc')
        .appendField(new Blockly.FieldTextInput('VIDX'), 'fourcc')
    this.appendDummyInput()
        .appendField('fps')
        .appendField(new Blockly.FieldTextInput('24'), 'fps');
    this.appendValueInput('frameSize')
        .appendField('frameSize')
        .setCheck('size');
    this.setPreviousStatement(true);
    this.setNextStatement(true);
    this.setInputsInline(true);
    this.setTooltip('videoio_VideoWriter_VideoWriter');
  },
  getVars: function() {
    return [this.getFieldValue('writer')];
  },
  renameVar: function(oldName, newName) {
    if (Blockly.Names.equals(oldName, this.getFieldValue('writer'))) {
      this.setFieldValue(newName, 'writer');
    }
  },
};
Blockly.Blocks['VideoWriter_write'] = {
  init: function() {
    this.setColour(22);
    this.appendDummyInput()
        .appendField('write')
        .appendField(new Blockly.FieldVariable('writer'), 'writer');
    this.appendValueInput('image')
        .appendField('image')
        .setCheck('image');
    this.setPreviousStatement(true);
    this.setNextStatement(true);
    this.setTooltip('videoio_VideoWriter_write');
  },
  getVars: function() {
    return [this.getFieldValue('writer')];
  },
  renameVar: function(oldName, newName) {
    if (Blockly.Names.equals(oldName, this.getFieldValue('writer'))) {
      this.setFieldValue(newName, 'writer');
    }
  },
};


Blockly.Python['VideoWriter_VideoWriter'] = function(block) {
  var writer = block.getFieldValue('writer');
  var filename = block.getFieldValue('filename')
  var fourcc = block.getFieldValue('fourcc')
  var fps = block.getFieldValue('fps');
  var frameSize = Blockly.Python.valueToCode(block, 'frameSize', Blockly.Python.ORDER_ATOMIC);
  var code = writer + " = cv2.VideoWriter('"+filename+"',"+"cv2.VideoWriter_fourcc(*'"+fourcc+"')"+","+fps+","+frameSize+")\n"
  code += "if not " + writer + ".isOpened(): raise Exception(\"your writer failed to open!\")\n"
  return code;
};
Blockly.Python['VideoWriter_write'] = function(block) {
  var that = block.getFieldValue('writer');
  var image = Blockly.Python.valueToCode(block, 'image', Blockly.Python.ORDER_ATOMIC);
  var code = that + ".write("+image+")\n"
  return code;
};

Blockly.Blocks['cvtcolor'] = {
  init: function() {
    this.setColour(65);
    this.appendDummyInput()
        .appendField(new Blockly.FieldDropdown([
          ["BGR2GRAY","cv2.COLOR_BGR2GRAY"],
          ["GRAY2BGR","cv2.COLOR_GRAY2BGR"],
          ["BGR2HSV", "cv2.COLOR_BGR2HSV"],
          ["HSV2BGR", "cv2.COLOR_HSV2BGR"],]), "flag");
    this.appendValueInput("img")
        .setCheck("image")
        .appendField("cvtColor");
    this.setOutput(true, "image");
    this.setTooltip('');
  }
};
Blockly.Python['cvtcolor'] = function(block) {
  var img = Blockly.Python.valueToCode(block, 'img', Blockly.Python.ORDER_ATOMIC);
  var flag = block.getFieldValue('flag');
  var code = "cv2.cvtColor("+img+","+flag+")";
  return [code, Blockly.Python.ORDER_NONE];
};


Blockly.Blocks['threshold'] = {
  init: function() {
    this.setColour(65);
    this.appendDummyInput()
        .appendField(new Blockly.FieldTextInput("30"), "thresh_val")
        .appendField(new Blockly.FieldTextInput("255"), "thresh_to")
        .appendField(new Blockly.FieldDropdown([
          ["BINARY","cv2.THRESH_BINARY"],
          ["BINARY_INV", "cv2.THRESH_BINARY_INV"],
          ["OTSU", "cv2.THRESH_OTSU"]]), "flag");
    this.appendValueInput("img")
        .appendField("threshold")
        .setCheck("image");
    this.setOutput(true, "image");
    this.setTooltip('');
  }
};
Blockly.Python['threshold'] = function(block) {
  var img = Blockly.Python.valueToCode(block, 'img', Blockly.Python.ORDER_ATOMIC);
  var flag = block.getFieldValue('flag');
  var thresh_val = block.getFieldValue('thresh_val');
  var thresh_to = block.getFieldValue('thresh_to');
  var code = "cv2.threshold("+img+","+thresh_val+","+thresh_to+","+flag+")[1]";
  return [code, Blockly.Python.ORDER_NONE];
};

Blockly.Blocks['newimage'] = {
  init: function() {
    this.setColour(65);
    this.appendDummyInput()
        .appendField("new image")
        .appendField(new Blockly.FieldTextInput("100"), "w")
        .appendField(new Blockly.FieldTextInput("100"), "h")
        .appendField(new Blockly.FieldDropdown([["bgr", "bgr"], ["gray","gray"], ["float", "float"]]), "type")
    this.appendValueInput("color")
        .appendField("color")
        //.setCheck("Colour");
    this.setOutput(true, "image");
    this.setTooltip('make a new, empty image');
  }
};
Blockly.Python['newimage'] = function(block) {
  var w = block.getFieldValue('w');
  var h = block.getFieldValue('h');
  var t = block.getFieldValue('type');
  var c = Blockly.Python.valueToCode(block, 'color', Blockly.Python.ORDER_ATOMIC);
  code = "np.ones(("+h+","+w+"),np.uint8)";
  if (t=="bgr")
    code = "np.ones(("+h+","+w+","+3+"),np.uint8)";
  if (t=="float")
    code = "np.ones(("+h+","+w+"),np.float)";
  if (c)
    code += " * " + c;
  return [code, Blockly.Python.ORDER_NONE];
};

Blockly.Blocks['point'] = {
  init: function() {
    this.setColour(65);
    this.appendDummyInput()
        .appendField("point")
        .appendField(new Blockly.FieldTextInput("0"), "x")
        .appendField(new Blockly.FieldTextInput("0"), "y")
    this.setOutput(true, "point");
    this.setTooltip('');
  }
};
Blockly.Python['point'] = function(block) {
  var x = block.getFieldValue('x');
  var y = block.getFieldValue('y');
  var code = "("+x+","+y+")";
  return [code, Blockly.Python.ORDER_NONE];
};

Blockly.Blocks['point_tl'] = {
  init: function() {
    this.setColour(65);
    this.appendValueInput("rect")
        .appendField("tl")
        .setCheck("rect");
    this.setOutput(true, "point");
    this.setTooltip('');
  }
};
Blockly.Python['point_tl'] = function(block) {
  var r = Blockly.Python.valueToCode(block, 'rect', Blockly.Python.ORDER_ATOMIC);
  var code = "("+r+"[0],"+r+"[1])";
  return [code, Blockly.Python.ORDER_NONE];
};

Blockly.Blocks['point_br'] = {
  init: function() {
    this.setColour(65);
    this.appendValueInput("rect")
        .appendField("br")
        .setCheck("rect");
    this.setOutput(true, "point");
    this.setTooltip('');
  }
};
Blockly.Python['point_br'] = function(block) {
  var r = Blockly.Python.valueToCode(block, 'rect', Blockly.Python.ORDER_ATOMIC);
  var code = "("+r+"[0]+" + r + "[2],"+r+"[1]+"+r+"[3])";
  return [code, Blockly.Python.ORDER_NONE];
};

Blockly.Blocks['size'] = {
  init: function() {
    this.setColour(65);
    this.appendDummyInput()
        .appendField("size")
        .appendField(new Blockly.FieldTextInput("0"), "w")
        .appendField(new Blockly.FieldTextInput("0"), "h")
    this.setOutput(true, "size");
    this.setTooltip('');
  }
};
Blockly.Python['size'] = function(block) {
  var w = block.getFieldValue('w');
  var h = block.getFieldValue('h');
  var code = "("+w+","+h+")";
  return [code, Blockly.Python.ORDER_NONE];
};

Blockly.Blocks['forRange'] = {
  init: function() {
    this.setColour(135);
    this.setInputsInline(true);
    this.appendDummyInput()
        .appendField("for");
    this.appendDummyInput()
        .appendField(new Blockly.FieldVariable('i'), 'i')
        .appendField("in range")
    this.appendValueInput("rend")
        .setCheck("Number");
    this.appendStatementInput("statement");
    this.setPreviousStatement(true);
    this.setNextStatement(true);
    this.setTooltip('');
  }
};
Blockly.Python['forRange'] = function(block) {
  var i = block.getFieldValue('i');
  var stop = Blockly.Python.valueToCode(block, 'rend', Blockly.Python.ORDER_ATOMIC);
  var s = Blockly.Python.statementToCode(block, 'statement') || '  pass\n';
  var code = "for ("+i+" in range("+stop+"):\n"+s;
  return code;
};

Blockly.Blocks['forEnum'] = {
  init: function() {
    this.setColour(135);
    this.setInputsInline(true);
    this.appendDummyInput()
        .appendField("for");
    this.appendDummyInput()
        .appendField(new Blockly.FieldVariable('index'), 'index')
        .appendField(new Blockly.FieldVariable('i'), 'i')
        .appendField("in")
    this.appendValueInput("list")
    this.appendStatementInput("statement");
    this.setPreviousStatement(true);
    this.setNextStatement(true);
    this.setTooltip('');
  },
  getVars: function() {
    return [this.getFieldValue('index'),this.getFieldValue('i')];
  },
  renameVar: function(oldName, newName) {
    if (Blockly.Names.equals(oldName, this.getFieldValue('index'))) { this.setFieldValue(newName, 'index'); }
    if (Blockly.Names.equals(oldName, this.getFieldValue('i'))) { this.setFieldValue(newName, 'i'); }
  },
};
Blockly.Python['forEnum'] = function(block) {
  var index = block.getFieldValue('index');
  var i = block.getFieldValue('i');
  var list = Blockly.Python.valueToCode(block, 'list', Blockly.Python.ORDER_ATOMIC);
  var s = Blockly.Python.statementToCode(block, 'statement') || '  pass\n';
  var code = "for "+index+","+i+" in enumerate("+list+"):\n"+s;
  return code;
};



    function fromXml(text) {
      var xml = Blockly.Xml.textToDom(text);
      Blockly.Xml.domToWorkspace(Blockly.mainWorkspace, xml);
    }
    function toXml() {
      var xml = Blockly.Xml.workspaceToDom(Blockly.mainWorkspace);
      return Blockly.Xml.domToPrettyText(xml);
    }

    function pyCode() {
      var code = Blockly.Python.workspaceToCode();
      return "\nimport cv2\nimport numpy as np\n\n" + code + "cv2.destroyAllWindows()"
    }

    function showPy() {
      var out = document.getElementById("blocklyCode");
      out.innerHTML = "<pre><code>" + pyCode() + "</code></pre>";
    }

    function ajax(url,data,cb) {
      var req = new XMLHttpRequest();
      req.open('POST', url, true);
      req.setRequestHeader('Content-Type', 'text/plain;');
      req.send(data);
	  if (!cb) return;
      req.onreadystatechange = function() {
        if ( req.readyState > 3 ) {
          cb(req.responseText)
        }
      }
    }
    function runPy() {
      ajax("/code",pyCode());
    }
    function savePrj() {
      var name = prompt("Please enter the project name");
      ajax("/save_code",name + "\n" + pyCode());
      ajax("/save_xml", name + "\n" + toXml());
    }
    function loadPrj()
    {
      var name = prompt("Please enter the project name");
      var txt = ajax("/load", name, fromXml);
    }

    setInterval(showPy, 100);
    
  </script>
  <style>
    body {
      background-color: #fff;
      font-family: sans-serif;
    }
    h1 {
      font-weight: normal;
      font-size: 140%;
    }
    button,input {
      border-style:solid;  border-width:4; border-color: #666;
      font-size: 120%; font-family: sans-serif;
      background-color: #ccc;
    }
    #container {
        width: 100%;
        height: 100%;
        position: relative;
    }

    #blocklyDiv {
        width: 100%;
        height: 90%;
        position: absolute;
        top: 60px;
        left: 0;
        opacity: 50%;
    }
    #blocklyCode {
        position: absolute;
        top: 30px;
        left: 680px;
        opacity: 50%;
    }

    #blocklyCode {
        z-index: 10;
    }
  </style>
</head>
<body>
   <p>
    <button onclick="runPy()">Run Python Code</button> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <button onclick="savePrj()">Save</button>
    <button onclick="loadPrj()">Load</button>
  </p>
  <div id="blocklyDiv" dir="LTR" ></div>
  <div id="blocklyCode"></div>

  <xml id="toolbox" style="display: none">
<category name="Basic">
  <block type="videocapture"></block>
  <block type="imread"></block>
  <block type="imshow"></block>
  <block type="waitkey"></block>
  <block type="onmouse"></block>
  <block type="colour_picker"></block>
  <block type="size"></block>
  <block type="point"></block>
  <block type="point_tl"></block>
  <block type="point_br"></block>
  <block type="newimage"></block>
  <block type="roi"></block>
  <block type="indexed"></block>
  <block type="imgsize"></block>
  <block type="convertTo"></block>
  <block type="cascade"></block>
  <block type="findobjects"></block>
  <block type="VideoWriter_VideoWriter"></block>
  <block type="VideoWriter_write"></block>
</category>   
<category name="core">
  <!--block type="core_borderInterpolate"></block-->
  <category name="Manipulate">
    <block type="core_mixChannels"></block>
    <block type="core_extractChannel"></block>
    <block type="core_insertChannel"></block>
    <block type="core_flip"></block>
    <block type="core_repeat"></block>
    <block type="core_hconcat"></block>
    <block type="core_vconcat"></block>
    <block type="core_copyMakeBorder"></block>
    <block type="core_normalize"></block>
    <block type="core_reduce"></block>
    <block type="core_merge"></block>
    <block type="core_split"></block>
  </category>
  <category name="Distance">
    <block type="core_norm"></block>
    <block type="core_PSNR"></block>
    <block type="core_Mahalanobis"></block>
    <block type="core_batchDistance"></block>
  </category>
  <category name="Maths">
    <block type="core_add"></block>
    <block type="core_subtract"></block>
    <block type="core_multiply"></block>
    <block type="core_divide"></block>
    <block type="core_scaleAdd"></block>
    <block type="core_addWeighted"></block>
    <block type="core_convertScaleAbs"></block>
    <block type="core_LUT"></block>
    <block type="core_sum"></block>
    <block type="core_countNonZero"></block>
    <block type="core_findNonZero"></block>
    <block type="core_mean"></block>
    <block type="core_meanStdDev"></block>
    <block type="core_bitwise_and"></block>
    <block type="core_bitwise_or"></block>
    <block type="core_bitwise_xor"></block>
    <block type="core_bitwise_not"></block>
    <block type="core_absdiff"></block>
    <block type="core_inRange"></block>
    <block type="core_compare"></block>
    <block type="core_min"></block>
    <block type="core_max"></block>
    <block type="core_sqrt"></block>
    <block type="core_pow"></block>
    <block type="core_exp"></block>
    <block type="core_log"></block>
    <block type="core_polarToCart"></block>
    <block type="core_cartToPolar"></block>
    <block type="core_phase"></block>
    <block type="core_magnitude"></block>
    <block type="core_patchNaNs"></block>
    <block type="core_gemm"></block>
    <block type="core_mulTransposed"></block>
    <block type="core_transpose"></block>
    <block type="core_transform"></block>
    <block type="core_perspectiveTransform"></block>
    <block type="core_completeSymm"></block>
    <block type="core_setIdentity"></block>
    <block type="core_determinant"></block>
    <block type="core_trace"></block>
    <block type="core_invert"></block>
    <block type="core_solve"></block>
    <block type="core_sort"></block>
    <block type="core_sortIdx"></block>
    <block type="core_solveCubic"></block>
    <block type="core_solvePoly"></block>
    <block type="core_eigen"></block>
    <block type="core_calcCovarMatrix"></block>
    <block type="core_PCACompute"></block>
    <block type="core_PCAProject"></block>
    <block type="core_PCABackProject"></block>
    <block type="core_SVDecomp"></block>
    <block type="core_SVBackSubst"></block>
    <block type="core_dft"></block>
    <block type="core_idft"></block>
    <block type="core_dct"></block>
    <block type="core_idct"></block>
    <block type="core_mulSpectrums"></block>
    <block type="core_getOptimalDFTSize"></block>
    <block type="core_randu"></block>
    <block type="core_randn"></block>
    <block type="core_kmeans"></block>
    <block type="core_cubeRoot"></block>
    <block type="core_fastAtan2"></block>
  </category>
  <category name="utils">
    <block type="core_getBuildInformation"></block>
    <block type="core_getTickCount"></block>
    <block type="core_getTickFrequency"></block>
    <block type="core_getCPUTickCount"></block>
    <block type="core_checkHardwareSupport"></block>
    <block type="core_getNumberOfCPUs"></block>
    <block type="core_setUseOptimized"></block>
    <block type="core_useOptimized"></block>
  </category>
</category>
<category name="imgproc">
  <category name="Misc">
    <block type="cvtcolor"></block>
    <block type="threshold"></block>
    <block type="imgproc_resize"></block>
    <block type="imgproc_adaptiveThreshold"></block>
    <block type="imgproc_getRectSubPix"></block>
    <block type="imgproc_logPolar"></block>
    <block type="imgproc_linearPolar"></block>
    <block type="imgproc_integral"></block>
    <block type="imgproc_accumulate"></block>
    <block type="imgproc_accumulateSquare"></block>
    <block type="imgproc_accumulateProduct"></block>
    <block type="imgproc_accumulateWeighted"></block>
    <block type="imgproc_applyColorMap"></block>
    <block type="imgproc_createHanningWindow"></block>
    <block type="imgproc_pyrDown"></block>
    <block type="imgproc_pyrUp"></block>
    <block type="imgproc_pyrMeanShiftFiltering"></block>
    <block type="imgproc_distanceTransform"></block>
    <block type="imgproc_demosaicing"></block>
  </category>
  <category name="Drawing">
    <block type="imgproc_line"></block>
    <block type="imgproc_arrowedLine"></block>
    <block type="imgproc_rectangle"></block>
    <block type="imgproc_circle"></block>
    <block type="imgproc_ellipse"></block>
    <block type="imgproc_fillConvexPoly"></block>
    <block type="imgproc_fillPoly"></block>
    <block type="imgproc_polylines"></block>
    <block type="imgproc_drawContours"></block>
    <block type="imgproc_putText"></block>
  </category>
  <category name="Filter">
    <block type="imgproc_getGaussianKernel"></block>
    <block type="imgproc_getDerivKernels"></block>
    <block type="imgproc_getGaborKernel"></block>
    <block type="imgproc_medianBlur"></block>
    <block type="imgproc_GaussianBlur"></block>
    <block type="imgproc_bilateralFilter"></block>
    <block type="imgproc_boxFilter"></block>
    <block type="imgproc_sqrBoxFilter"></block>
    <block type="imgproc_blur"></block>
    <block type="imgproc_filter2D"></block>
    <block type="imgproc_sepFilter2D"></block>
    <block type="imgproc_Sobel"></block>
    <block type="imgproc_Scharr"></block>
    <block type="imgproc_Laplacian"></block>
    <block type="imgproc_Canny"></block>
  </category>
  <category name="Morphology">
    <block type="imgproc_erode"></block>
    <block type="imgproc_dilate"></block>
    <block type="imgproc_getStructuringElement"></block>
    <block type="imgproc_morphologyEx"></block>
  </category>
  <category name="Warp">
    <block type="imgproc_warpAffine"></block>
    <block type="imgproc_warpPerspective"></block>
    <block type="imgproc_remap"></block>
    <block type="imgproc_getRotationMatrix2D"></block>
    <block type="imgproc_invertAffineTransform"></block>
    <block type="imgproc_getPerspectiveTransform"></block>
    <block type="imgproc_getAffineTransform"></block>
    <block type="imgproc_undistort"></block>
    <block type="imgproc_initUndistortRectifyMap"></block>
    <block type="imgproc_initWideAngleProjMap"></block>
    <block type="imgproc_getDefaultNewCameraMatrix"></block>
    <block type="imgproc_undistortPoints"></block>
    <block type="imgproc_convertMaps"></block>
  </category>
  <category name="Histogram">
    <block type="imgproc_calcHist"></block>
    <block type="imgproc_calcBackProject"></block>
    <block type="imgproc_compareHist"></block>
    <block type="imgproc_equalizeHist"></block>
  </category>
  <category name="Segment">
    <block type="imgproc_watershed"></block>
    <block type="imgproc_grabCut"></block>
  </category>
  <category name="Detect">
    <block type="imgproc_goodFeaturesToTrack"></block>
    <block type="imgproc_HoughLines"></block>
    <block type="imgproc_HoughLinesP"></block>
    <block type="imgproc_HoughCircles"></block>
    <block type="imgproc_cornerHarris"></block>
    <block type="imgproc_cornerEigenValsAndVecs"></block>
    <block type="imgproc_preCornerDetect"></block>
    <block type="imgproc_cornerSubPix"></block>
    <block type="imgproc_cornerMinEigenVal"></block>
  </category>
  <category name="Match">
    <block type="imgproc_matchTemplate"></block>
    <block type="imgproc_matchShapes"></block>
  </category>
  <category name="Shapes">
    <block type="findcontours"></block>
    <block type="imgproc_connectedComponents"></block>
    <block type="imgproc_connectedComponentsWithStats"></block>
    <block type="imgproc_approxPolyDP"></block>
    <block type="imgproc_arcLength"></block>
    <block type="imgproc_boundingRect"></block>
    <block type="imgproc_contourArea"></block>
    <block type="imgproc_boxPoints"></block>
    <block type="imgproc_minEnclosingTriangle"></block>
    <block type="imgproc_convexHull"></block>
    <block type="imgproc_convexityDefects"></block>
    <block type="imgproc_isContourConvex"></block>
    <block type="imgproc_intersectConvexConvex"></block>
    <block type="imgproc_fitLine"></block>
    <block type="imgproc_pointPolygonTest"></block>
    <block type="imgproc_rotatedRectangleIntersection"></block>
    <block type="imgproc_clipLine"></block>
    <block type="imgproc_ellipse2Poly"></block>
  </category>
  <category name="Clahe">
    <block type="imgproc_createCLAHE"></block>
    <block type="imgproc_CLAHE_apply"></block>
    <block type="imgproc_CLAHE_setClipLimit"></block>
    <block type="imgproc_CLAHE_setTilesGridSize"></block>
  </category>
  <category name="lines">
    <block type="imgproc_createLineSegmentDetector"></block>
    <block type="imgproc_LineSegmentDetector_detect"></block>
    <block type="imgproc_LineSegmentDetector_drawSegments"></block>
    <block type="imgproc_LineSegmentDetector_compareSegments"></block>
  </category>
</category>
<category name="photo">
  <block type="photo_inpaint"></block>
  <block type="photo_fastNlMeansDenoising"></block>
  <block type="photo_fastNlMeansDenoisingColored"></block>
  <block type="photo_fastNlMeansDenoisingMulti"></block>
  <block type="photo_fastNlMeansDenoisingColoredMulti"></block>
  <block type="photo_denoise_TVL1"></block>
  <block type="photo_createTonemap"></block>
  <block type="photo_createTonemapDrago"></block>
  <block type="photo_createTonemapDurand"></block>
  <block type="photo_createTonemapReinhard"></block>
  <block type="photo_createTonemapMantiuk"></block>
  <block type="photo_createAlignMTB"></block>
  <block type="photo_createCalibrateDebevec"></block>
  <block type="photo_createCalibrateRobertson"></block>
  <block type="photo_createMergeDebevec"></block>
  <block type="photo_createMergeMertens"></block>
  <block type="photo_createMergeRobertson"></block>
  <block type="photo_decolor"></block>
  <block type="photo_seamlessClone"></block>
  <block type="photo_colorChange"></block>
  <block type="photo_illuminationChange"></block>
  <block type="photo_textureFlattening"></block>
  <block type="photo_edgePreservingFilter"></block>
  <block type="photo_detailEnhance"></block>
  <block type="photo_pencilSketch"></block>
  <block type="photo_stylization"></block>
  <block type="photo_CalibrateRobertson_getMaxIter"></block>
  <block type="photo_CalibrateRobertson_setMaxIter"></block>
  <block type="photo_CalibrateRobertson_getThreshold"></block>
  <block type="photo_CalibrateRobertson_setThreshold"></block>
  <block type="photo_CalibrateRobertson_getRadiance"></block>
  <block type="photo_TonemapMantiuk_setScale"></block>
  <block type="photo_TonemapMantiuk_setSaturation"></block>
  <block type="photo_TonemapDurand_setSaturation"></block>
  <block type="photo_TonemapDurand_setContrast"></block>
  <block type="photo_TonemapDurand_setSigmaSpace"></block>
  <block type="photo_TonemapDurand_setSigmaColor"></block>
  <block type="photo_AlignExposures_process"></block>
  <block type="photo_CalibrateDebevec_setLambda"></block>
  <block type="photo_CalibrateDebevec_setSamples"></block>
  <block type="photo_CalibrateDebevec_setRandom"></block>
  <block type="photo_TonemapReinhard_setIntensity"></block>
  <block type="photo_TonemapReinhard_setLightAdaptation"></block>
  <block type="photo_TonemapReinhard_setColorAdaptation"></block>
  <block type="photo_MergeRobertson_process"></block>
  <block type="photo_CalibrateCRF_process"></block>
  <block type="photo_TonemapDrago_setSaturation"></block>
  <block type="photo_TonemapDrago_setBias"></block>
  <block type="photo_AlignMTB_process"></block>
  <block type="photo_AlignMTB_calculateShift"></block>
  <block type="photo_AlignMTB_shiftMat"></block>
  <block type="photo_AlignMTB_computeBitmaps"></block>
  <block type="photo_AlignMTB_setMaxBits"></block>
  <block type="photo_AlignMTB_setExcludeRange"></block>
  <block type="photo_AlignMTB_setCut"></block>
  <block type="photo_MergeDebevec_process"></block>
  <block type="photo_MergeMertens_process"></block>
  <block type="photo_MergeMertens_setContrastWeight"></block>
  <block type="photo_MergeMertens_setSaturationWeight"></block>
  <block type="photo_MergeMertens_setExposureWeight"></block>
  <block type="photo_MergeExposures_process"></block>
  <block type="photo_Tonemap_process"></block>
  <block type="photo_Tonemap_getGamma"></block>
  <block type="photo_Tonemap_setGamma"></block>
</category>
<category name="imgcodecs">
  <block type="imgcodecs_imread"></block>
  <block type="imgcodecs_imreadmulti"></block>
  <block type="imgcodecs_imwrite"></block>
  <block type="imgcodecs_imdecode"></block>
  <block type="imgcodecs_imencode"></block>
</category>
<category name="calib3d">
  <block type="calib3d_Rodrigues"></block>
  <block type="calib3d_findHomography"></block>
  <block type="calib3d_RQDecomp3x3"></block>
  <block type="calib3d_decomposeProjectionMatrix"></block>
  <block type="calib3d_matMulDeriv"></block>
  <block type="calib3d_composeRT"></block>
  <block type="calib3d_projectPoints"></block>
  <block type="calib3d_solvePnP"></block>
  <block type="calib3d_solvePnPRansac"></block>
  <block type="calib3d_initCameraMatrix2D"></block>
  <block type="calib3d_findChessboardCorners"></block>
  <block type="calib3d_drawChessboardCorners"></block>
  <block type="calib3d_findCirclesGrid"></block>
  <block type="calib3d_calibrateCamera"></block>
  <block type="calib3d_calibrationMatrixValues"></block>
  <block type="calib3d_stereoCalibrate"></block>
  <block type="calib3d_stereoRectify"></block>
  <block type="calib3d_stereoRectifyUncalibrated"></block>
  <block type="calib3d_rectify3Collinear"></block>
  <block type="calib3d_getOptimalNewCameraMatrix"></block>
  <block type="calib3d_convertPointsToHomogeneous"></block>
  <block type="calib3d_convertPointsFromHomogeneous"></block>
  <block type="calib3d_findFundamentalMat"></block>
  <block type="calib3d_findEssentialMat"></block>
  <block type="calib3d_decomposeEssentialMat"></block>
  <block type="calib3d_recoverPose"></block>
  <block type="calib3d_computeCorrespondEpilines"></block>
  <block type="calib3d_triangulatePoints"></block>
  <block type="calib3d_correctMatches"></block>
  <block type="calib3d_filterSpeckles"></block>
  <block type="calib3d_getValidDisparityROI"></block>
  <block type="calib3d_validateDisparity"></block>
  <block type="calib3d_reprojectImageTo3D"></block>
  <block type="calib3d_estimateAffine3D"></block>
  <block type="calib3d_decomposeHomographyMat"></block>
  <block type="calib3d_StereoBM_create"></block>
  <block type="calib3d_StereoBM_setPreFilterType"></block>
  <block type="calib3d_StereoBM_setPreFilterSize"></block>
  <block type="calib3d_StereoBM_setPreFilterCap"></block>
  <block type="calib3d_StereoBM_setTextureThreshold"></block>
  <block type="calib3d_StereoBM_setUniquenessRatio"></block>
  <block type="calib3d_StereoBM_setSmallerBlockSize"></block>
  <block type="calib3d_StereoBM_setROI1"></block>
  <block type="calib3d_StereoBM_setROI2"></block>
  <block type="calib3d_StereoSGBM_create"></block>
  <block type="calib3d_StereoSGBM_setPreFilterCap"></block>
  <block type="calib3d_StereoSGBM_setUniquenessRatio"></block>
  <block type="calib3d_StereoSGBM_setP1"></block>
  <block type="calib3d_StereoSGBM_setP2"></block>
  <block type="calib3d_StereoSGBM_setMode"></block>
  <block type="calib3d_StereoMatcher_compute"></block>
  <block type="calib3d_StereoMatcher_setMinDisparity"></block>
  <block type="calib3d_StereoMatcher_setNumDisparities"></block>
  <block type="calib3d_StereoMatcher_setBlockSize"></block>
  <block type="calib3d_StereoMatcher_setSpeckleWindowSize"></block>
  <block type="calib3d_StereoMatcher_setSpeckleRange"></block>
  <block type="calib3d_StereoMatcher_setDisp12MaxDiff"></block>
</category>
<category name="shape">
  <block type="shape_createNormHistogramCostExtractor"></block>
  <block type="shape_createEMDHistogramCostExtractor"></block>
  <block type="shape_createChiHistogramCostExtractor"></block>
  <block type="shape_createEMDL1HistogramCostExtractor"></block>
  <block type="shape_createShapeContextDistanceExtractor"></block>
  <block type="shape_createHausdorffDistanceExtractor"></block>
  <block type="shape_createThinPlateSplineShapeTransformer"></block>
  <block type="shape_createAffineTransformer"></block>
  <block type="shape_ThinPlateSplineShapeTransformer_setRegularizationParameter"></block>
  <block type="shape_NormHistogramCostExtractor_setNormFlag"></block>
  <block type="shape_ShapeTransformer_estimateTransformation"></block>
  <block type="shape_ShapeTransformer_applyTransformation"></block>
  <block type="shape_ShapeTransformer_warpImage"></block>
  <block type="shape_EMDHistogramCostExtractor_setNormFlag"></block>
  <block type="shape_ShapeDistanceExtractor_computeDistance"></block>
  <block type="shape_ShapeContextDistanceExtractor_setAngularBins"></block>
  <block type="shape_ShapeContextDistanceExtractor_setRadialBins"></block>
  <block type="shape_ShapeContextDistanceExtractor_setInnerRadius"></block>
  <block type="shape_ShapeContextDistanceExtractor_setOuterRadius"></block>
  <block type="shape_ShapeContextDistanceExtractor_setRotationInvariant"></block>
  <block type="shape_ShapeContextDistanceExtractor_setShapeContextWeight"></block>
  <block type="shape_ShapeContextDistanceExtractor_setImageAppearanceWeight"></block>
  <block type="shape_ShapeContextDistanceExtractor_setBendingEnergyWeight"></block>
  <block type="shape_ShapeContextDistanceExtractor_setImages"></block>
  <block type="shape_ShapeContextDistanceExtractor_getImages"></block>
  <block type="shape_ShapeContextDistanceExtractor_setIterations"></block>
  <block type="shape_ShapeContextDistanceExtractor_setCostExtractor"></block>
  <block type="shape_ShapeContextDistanceExtractor_setStdDev"></block>
  <block type="shape_ShapeContextDistanceExtractor_setTransformAlgorithm"></block>
  <block type="shape_HausdorffDistanceExtractor_setDistanceFlag"></block>
  <block type="shape_HausdorffDistanceExtractor_setRankProportion"></block>
  <block type="shape_AffineTransformer_setFullAffine"></block>
  <block type="shape_AffineTransformer_getFullAffine"></block>
  <block type="shape_HistogramCostExtractor_buildCostMatrix"></block>
  <block type="shape_HistogramCostExtractor_setNDummies"></block>
  <block type="shape_HistogramCostExtractor_setDefaultCost"></block>
</category>
<category name="video">
  <category name="Flow">
    <block type="video_meanShift"></block>
    <block type="video_buildOpticalFlowPyramid"></block>
    <block type="video_calcOpticalFlowPyrLK"></block>
    <block type="video_calcOpticalFlowFarneback"></block>
    <block type="video_createOptFlow_DualTVL1"></block>
    <block type="video_DenseOpticalFlow_calc"></block>
    <block type="video_DenseOpticalFlow_collectGarbage"></block>
  </category>
  <category name="Misc">
    <block type="video_estimateRigidTransform"></block>
    <block type="video_findTransformECC"></block>
    <block type="video_KalmanFilter_KalmanFilter"></block>
    <block type="video_KalmanFilter_predict"></block>
    <block type="video_KalmanFilter_correct"></block>
  </category>
  <category name="BGSep">
    <block type="video_createBackgroundSubtractorMOG2"></block>
    <block type="video_createBackgroundSubtractorKNN"></block>
    <block type="video_BackgroundSubtractor_apply"></block>
    <block type="video_BackgroundSubtractor_getBackgroundImage"></block>
    <block type="video_BackgroundSubtractorMOG2_getHistory"></block>
    <block type="video_BackgroundSubtractorMOG2_setHistory"></block>
    <block type="video_BackgroundSubtractorMOG2_getNMixtures"></block>
    <block type="video_BackgroundSubtractorMOG2_setNMixtures"></block>
    <block type="video_BackgroundSubtractorMOG2_getBackgroundRatio"></block>
    <block type="video_BackgroundSubtractorMOG2_setBackgroundRatio"></block>
    <block type="video_BackgroundSubtractorMOG2_getVarThreshold"></block>
    <block type="video_BackgroundSubtractorMOG2_setVarThreshold"></block>
    <block type="video_BackgroundSubtractorMOG2_getVarThresholdGen"></block>
    <block type="video_BackgroundSubtractorMOG2_setVarThresholdGen"></block>
    <block type="video_BackgroundSubtractorMOG2_getVarInit"></block>
    <block type="video_BackgroundSubtractorMOG2_setVarInit"></block>
    <block type="video_BackgroundSubtractorMOG2_getVarMin"></block>
    <block type="video_BackgroundSubtractorMOG2_setVarMin"></block>
    <block type="video_BackgroundSubtractorMOG2_getVarMax"></block>
    <block type="video_BackgroundSubtractorMOG2_setVarMax"></block>
    <block type="video_BackgroundSubtractorMOG2_getComplexityReductionThreshold"></block>
    <block type="video_BackgroundSubtractorMOG2_setComplexityReductionThreshold"></block>
    <block type="video_BackgroundSubtractorMOG2_getDetectShadows"></block>
    <block type="video_BackgroundSubtractorMOG2_setDetectShadows"></block>
    <block type="video_BackgroundSubtractorMOG2_getShadowValue"></block>
    <block type="video_BackgroundSubtractorMOG2_setShadowValue"></block>
    <block type="video_BackgroundSubtractorMOG2_getShadowThreshold"></block>
    <block type="video_BackgroundSubtractorMOG2_setShadowThreshold"></block>
    <block type="video_BackgroundSubtractorKNN_getHistory"></block>
    <block type="video_BackgroundSubtractorKNN_setHistory"></block>
    <block type="video_BackgroundSubtractorKNN_getNSamples"></block>
    <block type="video_BackgroundSubtractorKNN_setNSamples"></block>
    <block type="video_BackgroundSubtractorKNN_getDist2Threshold"></block>
    <block type="video_BackgroundSubtractorKNN_setDist2Threshold"></block>
    <block type="video_BackgroundSubtractorKNN_getkNNSamples"></block>
    <block type="video_BackgroundSubtractorKNN_setkNNSamples"></block>
    <block type="video_BackgroundSubtractorKNN_getDetectShadows"></block>
    <block type="video_BackgroundSubtractorKNN_setDetectShadows"></block>
    <block type="video_BackgroundSubtractorKNN_getShadowValue"></block>
    <block type="video_BackgroundSubtractorKNN_setShadowValue"></block>
    <block type="video_BackgroundSubtractorKNN_getShadowThreshold"></block>
    <block type="video_BackgroundSubtractorKNN_setShadowThreshold"></block>
  </category>
</category>
<category name="features2d">
  <category name="General">
    <block type="features2d_drawMatches"></block>
    <block type="features2d_drawKeypoints"></block>
    <block type="features2d_Feature2D_detect"></block>
    <block type="features2d_Feature2D_compute"></block>
    <block type="features2d_Feature2D_detectAndCompute"></block>
    <block type="features2d_Feature2D_empty"></block>
    <block type="features2d_BRISK_create"></block>
    <block type="features2d_FastFeatureDetector_create"></block>
    <block type="features2d_FastFeatureDetector_setThreshold"></block>
    <block type="features2d_FastFeatureDetector_setNonmaxSuppression"></block>
    <block type="features2d_FastFeatureDetector_setType"></block>
  </category>
  <category name="Match">
    <block type="features2d_BFMatcher_BFMatcher"></block>
    <block type="features2d_FlannBasedMatcher_FlannBasedMatcher"></block>
    <block type="features2d_DescriptorMatcher_add"></block>
    <block type="features2d_DescriptorMatcher_clear"></block>
    <block type="features2d_DescriptorMatcher_empty"></block>
    <block type="features2d_DescriptorMatcher_isMaskSupported"></block>
    <block type="features2d_DescriptorMatcher_train"></block>
    <block type="features2d_DescriptorMatcher_match"></block>
    <block type="features2d_DescriptorMatcher_knnMatch"></block>
    <block type="features2d_DescriptorMatcher_create"></block>
  </category>
  <category name="GFTT">
    <block type="features2d_GFTTDetector_create"></block>
    <block type="features2d_GFTTDetector_setMaxFeatures"></block>
    <block type="features2d_GFTTDetector_setQualityLevel"></block>
    <block type="features2d_GFTTDetector_setMinDistance"></block>
    <block type="features2d_GFTTDetector_setBlockSize"></block>
    <block type="features2d_GFTTDetector_setHarrisDetector"></block>
    <block type="features2d_GFTTDetector_setK"></block>
  </category>
  <category name="KAZE">
    <block type="features2d_KAZE_create"></block>
    <block type="features2d_KAZE_setExtended"></block>
    <block type="features2d_KAZE_setUpright"></block>
    <block type="features2d_KAZE_setThreshold"></block>
    <block type="features2d_KAZE_setNOctaves"></block>
    <block type="features2d_KAZE_setNOctaveLayers"></block>
    <block type="features2d_KAZE_setDiffusivity"></block>
    <block type="features2d_AKAZE_create"></block>
    <block type="features2d_AKAZE_setDescriptorType"></block>
    <block type="features2d_AKAZE_setDescriptorSize"></block>
    <block type="features2d_AKAZE_setDescriptorChannels"></block>
    <block type="features2d_AKAZE_setThreshold"></block>
    <block type="features2d_AKAZE_setNOctaves"></block>
    <block type="features2d_AKAZE_setNOctaveLayers"></block>
    <block type="features2d_AKAZE_setDiffusivity"></block>
  </category>
  <category name="ORB">
    <block type="features2d_ORB_create"></block>
    <block type="features2d_ORB_setMaxFeatures"></block>
    <block type="features2d_ORB_setScaleFactor"></block>
    <block type="features2d_ORB_setNLevels"></block>
    <block type="features2d_ORB_setEdgeThreshold"></block>
    <block type="features2d_ORB_setFastThreshold"></block>
    <block type="features2d_ORB_setFirstLevel"></block>
    <block type="features2d_ORB_setPatchSize"></block>
    <block type="features2d_ORB_setWTA_K"></block>
    <block type="features2d_ORB_setScoreType"></block>
  </category>
  <category name="MSER">
    <block type="features2d_MSER_create"></block>
    <block type="features2d_MSER_detectRegions"></block>
    <block type="features2d_MSER_setDelta"></block>
    <block type="features2d_MSER_setMinArea"></block>
    <block type="features2d_MSER_setMaxArea"></block>
    <block type="features2d_MSER_setPass2Only"></block>
  </category>
  <category name="nonfree">
    <block type="xfeatures2d_SURF_create"></block>
    <block type="xfeatures2d_SURF_setHessianThreshold"></block>
    <block type="xfeatures2d_SURF_setNOctaves"></block>
    <block type="xfeatures2d_SURF_setNOctaveLayers"></block>
    <block type="xfeatures2d_SURF_setExtended"></block>
    <block type="xfeatures2d_SURF_setUpright"></block>
    <block type="xfeatures2d_SIFT_create"></block>
  </category>
</category>
<hr>

    <category name="Logic">
      <block type="controls_if"></block>
      <block type="logic_compare"></block>
      <block type="logic_operation"></block>
      <block type="logic_negate"></block>
      <block type="logic_boolean"></block>
    </category>

    <category name="Loops">
      <block type="controls_repeat_ext">
        <value name="TIMES">
          <block type="math_number">
            <field name="NUM">10</field>
          </block>
        </value>
      </block>
      <block type="controls_whileUntil"></block>
        <value name="FROM">
          <block type="math_number">
            <field name="NUM">1</field>
          </block>
        </value>
        <value name="TO">
          <block type="math_number">
            <field name="NUM">10</field>
          </block>
        </value>
        <value name="BY">
          <block type="math_number">
            <field name="NUM">1</field>
          </block>
        </value>
      </block>
      <block type="controls_forEach"></block>
      <block type="forRange"></block>
      <block type="forEnum"></block>
      <block type="controls_flow_statements"></block>
    </category>
    <category name="Math">
      <block type="math_number"></block>
      <block type="math_arithmetic"></block>
      <block type="math_single"></block>
      <block type="math_trig"></block>
      <block type="math_constant"></block>
      <block type="math_number_property"></block>
      <block type="math_change">
        <value name="DELTA">
          <block type="math_number">
            <field name="NUM">1</field>
          </block>
        </value>
      </block>
      <block type="math_round"></block>
      <block type="math_on_list"></block>
      <block type="math_modulo"></block>
      <block type="math_constrain">
        <value name="LOW">
          <block type="math_number">
            <field name="NUM">1</field>
          </block>
        </value>
        <value name="HIGH">
          <block type="math_number">
            <field name="NUM">100</field>
          </block>
        </value>
      </block>
      <block type="math_random_int">
        <value name="FROM">
          <block type="math_number">
            <field name="NUM">1</field>
          </block>
        </value>
        <value name="TO">
          <block type="math_number">
            <field name="NUM">100</field>
          </block>
        </value>
      </block>
      <block type="math_random_float"></block>
    </category>
    <category name="Text">
      <block type="text_print"></block>
      <block type="text"></block>
      <block type="text_join"></block>
      <block type="text_append">
        <value name="TEXT">
          <block type="text"></block>
        </value>
      </block>
      <block type="text_length"></block>
      <block type="text_isEmpty"></block>
      <block type="text_indexOf">
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR" class="textVar">...</field>
          </block>
        </value>
      </block>
      <block type="text_charAt">
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR" class="textVar">...</field>
          </block>
        </value>
      </block>
      <block type="text_getSubstring">
        <value name="STRING">
          <block type="variables_get">
            <field name="VAR" class="textVar">...</field>
          </block>
        </value>
      </block>
      <block type="text_changeCase"></block>
      <block type="text_trim"></block>
      <block type="text_prompt_ext">
        <value name="TEXT">
          <block type="text"></block>
        </value>
      </block>
    </category>
    <category name="Lists">
      <block type="lists_create_empty"></block>
      <block type="lists_create_with"></block>
      <block type="lists_append"></block>
      <block type="lists_length"></block>
      <block type="lists_isEmpty"></block>
      <block type="lists_indexOf">
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR" class="listVar">...</field>
          </block>
        </value>
      </block>
      <block type="lists_getIndex">
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR" class="listVar">...</field>
          </block>
        </value>
      </block>
      <block type="lists_setIndex">
        <value name="LIST">
          <block type="variables_get">
            <field name="VAR" class="listVar">...</field>
          </block>
        </value>
      </block>
      <block type="lists_getSublist">
        <value name="LIST">
          <block type="variables_get">
            <field name="VAR" class="listVar">...</field>
          </block>
        </value>
      </block>
    </category>
    <category name="Variables" custom="VARIABLE"></category>
    <!--category name="Functions" custom="PROCEDURE"></category-->
  </xml>

  <script>
    Blockly.inject(document.getElementById('blocklyDiv'),
        {toolbox: document.getElementById('toolbox')});

  </script>
  <div style="direction: ltr;" class="blocklyWidgetDiv"></div>

</body>
</html>
